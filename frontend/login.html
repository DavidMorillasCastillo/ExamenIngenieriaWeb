<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Login - Esqueleto</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
    <div class="container" style="max-width: 400px; text-align: center; margin-top: 100px;">
        <h2>Acceso Proyecto ðŸš€</h2>
        
        <div id="g_id_onload"
             data-client_id="943835898814-s61190dcv61mgic6ra40f5uba5ir38dg.apps.googleusercontent.com"
             data-callback="handleCredentialResponse"
             data-auto_select="false">
        </div>
        <div class="g_id_signin" data-type="standard" data-size="large" data-theme="outline" data-text="sign_in_with"></div>
    </div>

    <script>
        // CAMBIAR EN PRODUCCIÃ“N
       const API_URL = "http://localhost:8000"; 
        //const API_URL = "https://exameningenieriaweb.onrender.com";
        async function handleCredentialResponse(response) {
            try {
                const res = await fetch(`${API_URL}/google-login`, { 
                    method: "POST", 
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ token: response.credential })
                });

                if (!res.ok) throw new Error("Fallo en login");
                
                const data = await res.json();
                localStorage.setItem("token", data.access_token);
                localStorage.setItem("username", data.email);
                window.location.href = "index.html";

            } catch (err) {
                alert("Error: " + err.message);
            }
        }
    </script>
</body>
</html>